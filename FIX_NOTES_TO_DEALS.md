# ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∞—Å–æ—Ü—ñ–∞—Ü—ñ—ó Notes –∑ Deals –≤ HubSpot

## üîß –©–æ –±—É–ª–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞
Notes —Å—Ç–≤–æ—Ä—é–≤–∞–ª–∏—Å—è –≤ HubSpot, –∞–ª–µ –Ω–µ –∞—Å–æ—Ü—ñ—é–≤–∞–ª–∏—Å—è –∑ deals, —Ç–æ–º—É –≤–æ–Ω–∏ –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞–ª–∏—Å—è –≤ deal.

### –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
1. **–î–æ–¥–∞–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è batch API** –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Å–æ—Ü—ñ–∞—Ü—ñ—ó (–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç HubSpot v4)
2. **–î–æ–¥–∞–Ω–æ fallback** –¥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ PUT –∑–∞–ø–∏—Ç—É, —è–∫—â–æ batch API –Ω–µ –ø—Ä–∞—Ü—é—î
3. **–ü–æ–∫—Ä–∞—â–µ–Ω–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è** –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º

### –§–æ—Ä–º–∞—Ç –∑–∞–ø–∏—Ç—É
–¢–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è HubSpot v4 API:
```json
{
  "inputs": [{
    "from": {
      "id": "note_id"
    },
    "to": {
      "id": "deal_id"
    },
    "type": "note_to_deal"
  }]
}
```

---

## üìã –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

```bash
cd /home/pro-part-agent/htdocs/agent.pro-part.online/propart-real-estate-hub
git pull origin main
sudo systemctl restart propart
```

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:

1. **–î–æ–¥–∞–π—Ç–µ –Ω–æ–≤–∏–π –∫–æ–º–µ–Ω—Ç–∞—Ä** –¥–æ –ª—ñ–¥–∞ –∑ `hubspot_deal_id`
2. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:**
   ```bash
   sudo journalctl -u propart -f | grep -i "note\|deal\|–∞—Å–æ—Ü—ñ–∞—Ü—ñ—è\|association"
   ```
   
   –®—É–∫–∞–π—Ç–µ:
   - `üìù –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Å–æ—Ü—ñ–∞—Ü—ñ—ó note X –∑ deal Y` - –∞—Å–æ—Ü—ñ–∞—Ü—ñ—è –ø–æ—á–∞–ª–∞—Å—è
   - `‚úÖ –ù–æ—Ç–∞—Ç–∫–∞ –∞—Å–æ—Ü—ñ–π–æ–≤–∞–Ω–∞ –∑ deal —á–µ—Ä–µ–∑ batch API` - —É—Å–ø—ñ—à–Ω–æ —á–µ—Ä–µ–∑ batch
   - `‚úÖ –ù–æ—Ç–∞—Ç–∫–∞ –∞—Å–æ—Ü—ñ–π–æ–≤–∞–Ω–∞ –∑ deal —á–µ—Ä–µ–∑ PUT` - —É—Å–ø—ñ—à–Ω–æ —á–µ—Ä–µ–∑ fallback
   - `‚ùå –ê—Å–æ—Ü—ñ–∞—Ü—ñ—è –Ω–µ –≤–¥–∞–ª–∞—Å—è` - –ø–æ–º–∏–ª–∫–∞ (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–µ—Ç–∞–ª—ñ)

3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤ HubSpot:**
   - –í—ñ–¥–∫—Ä–∏–π—Ç–µ deal –≤ HubSpot
   - –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –≤–∫–ª–∞–¥–∫–∏ "Notes" –∞–±–æ "Activity"
   - –ú–∞—î –∑'—è–≤–∏—Ç–∏—Å—è –Ω–æ–≤–∞ –Ω–æ—Ç–∞—Ç–∫–∞ –∑ —Ç–µ–∫—Å—Ç–æ–º –∫–æ–º–µ–Ω—Ç–∞—Ä—è

---

## üí° –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î —Ç–µ–ø–µ—Ä

1. **–°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∫–æ–º–µ–Ω—Ç–∞—Ä** –≤ –ª–æ–∫–∞–ª—å–Ω—ñ–π –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
2. **–°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è note** –≤ HubSpot —á–µ—Ä–µ–∑ v3 API
3. **–°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞—Å–æ—Ü—ñ–∞—Ü—ñ—è** –º—ñ–∂ note —Ç–∞ deal —á–µ—Ä–µ–∑:
   - **Batch API** (—Å–ø–æ—á–∞—Ç–∫—É) - –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è v4
   - **PUT –∑–∞–ø–∏—Ç** (fallback) - —è–∫—â–æ batch –Ω–µ –ø—Ä–∞—Ü—é—î

---

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ

- Notes –±—É–¥—É—Ç—å –∞—Å–æ—Ü—ñ–π–æ–≤–∞–Ω—ñ –∑ deals **–¢–Ü–õ–¨–ö–ò** —è–∫—â–æ –ª—ñ–¥ –º–∞—î `hubspot_deal_id`
- –Ø–∫—â–æ –ª—ñ–¥ –Ω–µ –º–∞—î `hubspot_deal_id`, —Å–ø–æ—á–∞—Ç–∫—É –≤–∏–∫–æ–Ω–∞–π—Ç–µ:
  ```bash
  python3 sync_lead_to_hubspot.py
  ```

---

## üîç –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

–Ø–∫—â–æ notes –≤—Å–µ —â–µ –Ω–µ –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ deals:

1. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –ø—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—è:**
   ```bash
   sudo journalctl -u propart -f --since "5 minutes ago" | grep -i "note\|deal\|–∞—Å–æ—Ü—ñ–∞—Ü—ñ—è"
   ```

2. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ note —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è:**
   - –®—É–∫–∞–π—Ç–µ `‚úÖ –ù–æ—Ç–∞—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∞ –≤ HubSpot: X`
   - –Ø–∫—â–æ —î, –∞–ª–µ –∞—Å–æ—Ü—ñ–∞—Ü—ñ—è –Ω–µ –ø—Ä–∞—Ü—é—î, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ–º–∏–ª–∫–∏ –∞—Å–æ—Ü—ñ–∞—Ü—ñ—ó

3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤ HubSpot:**
   - –í—ñ–¥–∫—Ä–∏–π—Ç–µ deal
   - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ —î note –≤ —Å–ø–∏—Å–∫—É notes (–º–æ–∂–ª–∏–≤–æ, –≤–æ–Ω–∞ –Ω–µ –∞—Å–æ—Ü—ñ–π–æ–≤–∞–Ω–∞)

4. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ API –∫–ª—é—á:**
   - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ API –∫–ª—é—á –º–∞—î –ø—Ä–∞–≤–∞ –Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è notes —Ç–∞ associations

