# üî¥ –ö–†–ò–¢–ò–ß–ù–Ü –ü–†–û–ë–õ–ï–ú–ò –ü–†–û–ï–ö–¢–£ PRO-PART HUB

## üìä –®–í–ò–î–ö–ò–ô –û–ì–õ–Ø–î

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ü—Ä–∞—Ü—é—î, –∞–ª–µ –ù–ï –≥–æ—Ç–æ–≤–∏–π –¥–æ production  
**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞:** 6/10  
**–ö—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º:** 5  
**–í–∞–∂–ª–∏–≤–∏—Ö –ø—Ä–æ–±–ª–µ–º:** 5  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π:** 5

---

## üö® –¢–û–ü-5 –ö–†–ò–¢–ò–ß–ù–ò–• –ü–†–û–ë–õ–ï–ú

### 1. üí• –í–Ü–î–°–£–¢–ù–Ü–°–¢–¨ –û–ë–†–û–ë–ö–ò –ü–û–ú–ò–õ–û–ö –ë–î
**–©–æ –Ω–µ —Ç–∞–∫:**
- –°–∏—Å—Ç–µ–º–∞ –≤–ø–∞–¥–µ –ø—Ä–∏ –≤—Ç—Ä–∞—Ç—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ PostgreSQL
- –ù–µ–º–∞—î connection pooling
- –ù–µ–º–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ reconnect

**–Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:**
```bash
# –î–æ–¥–∞—Ç–∏ –¥–æ app.py –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é:
app.config['SQLALCHEMY_ENGINE_OPTIONS'] = {
    'pool_size': 10,
    'pool_recycle': 3600,
    'pool_pre_ping': True
}
```

**–¢–µ—Ä–º—ñ–Ω–æ–≤—ñ—Å—Ç—å:** üî¥ –¢–ï–†–ú–Ü–ù–û–í–û (1-2 –¥–Ω—ñ)

---

### 2. üìù –ù–ï–ú–ê–Ñ –õ–û–ì–£–í–ê–ù–ù–Ø
**–©–æ –Ω–µ —Ç–∞–∫:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ print()
- –ù–µ–º–æ–∂–ª–∏–≤–æ –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏
- –ù–µ–º–∞—î audit trail

**–Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:**
```python
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ proper logging
import logging
from logging.handlers import RotatingFileHandler

file_handler = RotatingFileHandler('logs/propart.log', maxBytes=10240000)
app.logger.addHandler(file_handler)
app.logger.setLevel(logging.INFO)
```

**–¢–µ—Ä–º—ñ–Ω–æ–≤—ñ—Å—Ç—å:** üî¥ –¢–ï–†–ú–Ü–ù–û–í–û (1-2 –¥–Ω—ñ)

---

### 3. üö¶ HUBSPOT API –ë–ï–ó RATE LIMITING
**–©–æ –Ω–µ —Ç–∞–∫:**
- –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥ - –∑–∞–Ω–∞–¥—Ç–æ —á–∞—Å—Ç–æ!
- HubSpot –º–∞—î –ª—ñ–º—ñ—Ç 100 requests/10 sec
- –ù–µ–º–∞—î retry logic –¥–ª—è –ø–æ–º–∏–ª–æ–∫ 429

**–Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:**
```python
# –ó–±—ñ–ª—å—à–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó
setInterval(function() { ... }, 300000); // 5 —Ö–≤–∏–ª–∏–Ω –∑–∞–º—ñ—Å—Ç—å 30 —Å–µ–∫

# –î–æ–¥–∞—Ç–∏ rate limiter
from ratelimit import limits, sleep_and_retry

@sleep_and_retry
@limits(calls=90, period=10)
def sync_lead_from_hubspot(lead):
    # ...
```

**–¢–µ—Ä–º—ñ–Ω–æ–≤—ñ—Å—Ç—å:** üî¥ –¢–ï–†–ú–Ü–ù–û–í–û (1-2 –¥–Ω—ñ)

---

### 4. üîê –°–õ–ê–ë–ö–ê –ë–ï–ó–ü–ï–ö–ê
**–©–æ –Ω–µ —Ç–∞–∫:**
- ‚ùå SECRET_KEY –º–∞—î —Å–ª–∞–±–∫–∏–π fallback
- ‚ùå –ù–µ–º–∞—î CSRF –∑–∞—Ö–∏—Å—Ç—É
- ‚ùå –ù–µ–º–∞—î rate limiting –¥–ª—è login
- ‚ùå –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Werkzeug –∑–∞–º—ñ—Å—Ç—å bcrypt

**–Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:**
```bash
pip install Flask-WTF Flask-Limiter Flask-Bcrypt

# –í app.py:
from flask_wtf.csrf import CSRFProtect
from flask_limiter import Limiter
from flask_bcrypt import Bcrypt

csrf = CSRFProtect(app)
limiter = Limiter(app, key_func=get_remote_address)
bcrypt = Bcrypt(app)
```

**–¢–µ—Ä–º—ñ–Ω–æ–≤—ñ—Å—Ç—å:** üî¥ –¢–ï–†–ú–Ü–ù–û–í–û (2-3 –¥–Ω—ñ)

---

### 5. üóÑÔ∏è –ù–ï–ú–ê–Ñ –ú–Ü–ì–†–ê–¶–Ü–ô–ù–û–á –°–ò–°–¢–ï–ú–ò
**–©–æ –Ω–µ —Ç–∞–∫:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è db.create_all()
- –ù–µ–º–æ–∂–ª–∏–≤–æ –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ –∑–º—ñ–Ω–∏ —Å—Ö–µ–º–∏
- –°–∫–ª–∞–¥–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ production –ë–î

**–Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:**
```bash
pip install alembic
alembic init migrations
alembic revision --autogenerate -m "Initial migration"
alembic upgrade head
```

**–¢–µ—Ä–º—ñ–Ω–æ–≤—ñ—Å—Ç—å:** üü° –í–ê–ñ–õ–ò–í–û (1 —Ç–∏–∂–¥–µ–Ω—å)

---

## ‚ö†Ô∏è –¢–û–ü-5 –í–ê–ñ–õ–ò–í–ò–• –ü–†–û–ë–õ–ï–ú

### 6. ‚úÖ –ù–µ–º–∞—î –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö –Ω–∞ backend
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ frontend
- –ú–æ–∂–ª–∏–≤–∞ SQL injection

### 7. üêå N+1 Query –ø—Ä–æ–±–ª–µ–º–∞
- –ü–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏ —á–µ—Ä–µ–∑ –Ω–µ–æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ SQL
- –¢—Ä–µ–±–∞ –¥–æ–¥–∞—Ç–∏ joinedload

### 8. üìÑ –ù–µ–º–∞—î –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó
- –í—Å—ñ –ª—ñ–¥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –æ–¥—Ä–∞–∑—É
- –ü–æ–≤—ñ–ª—å–Ω–æ –ø—Ä–∏ –±–∞–≥–∞—Ç—å–æ—Ö –∑–∞–ø–∏—Å–∞—Ö

### 9. üîç –ù–µ–º–∞—î —ñ–Ω–¥–µ–∫—Å—ñ–≤ –ë–î
- –ü–æ–≤—ñ–ª—å–Ω—ñ –ø–æ—à—É–∫–æ–≤—ñ –∑–∞–ø–∏—Ç–∏
- –¢—Ä–µ–±–∞ –¥–æ–¥–∞—Ç–∏ —ñ–Ω–¥–µ–∫—Å–∏ –Ω–∞ agent_id, status, created_at

### 10. üíæ –ù–µ–º–∞—î –∫–µ—à—É–≤–∞–Ω–Ω—è
- –ö–æ–∂–µ–Ω –∑–∞–ø–∏—Ç —Ä–æ–±–∏—Ç—å SQL queries
- –¢—Ä–µ–±–∞ –¥–æ–¥–∞—Ç–∏ Redis

---

## üìã –®–í–ò–î–ö–ò–ô –ü–õ–ê–ù –î–Ü–ô

### –¶–¨–û–ì–û –¢–ò–ñ–ù–Ø (–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 1):
- [ ] –î–µ–Ω—å 1-2: –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è
- [ ] –î–µ–Ω—å 2-3: –í–∏–ø—Ä–∞–≤–∏—Ç–∏ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫ –ë–î
- [ ] –î–µ–Ω—å 3-4: –î–æ–¥–∞—Ç–∏ rate limiting –¥–ª—è HubSpot
- [ ] –î–µ–Ω—å 4-5: –í–∏–ø—Ä–∞–≤–∏—Ç–∏ –±–µ–∑–ø–µ–∫—É (CSRF, bcrypt, rate limiting)

### –ù–ê–°–¢–£–ü–ù–û–ì–û –¢–ò–ñ–ù–Ø (–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 2):
- [ ] –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Alembic
- [ ] –î–æ–¥–∞—Ç–∏ —ñ–Ω–¥–µ–∫—Å–∏ –ë–î
- [ ] –í–∏–ø—Ä–∞–≤–∏—Ç–∏ N+1 queries
- [ ] –î–æ–¥–∞—Ç–∏ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é
- [ ] –î–æ–¥–∞—Ç–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –Ω–∞ backend

### –ß–ï–†–ï–ó –ú–Ü–°–Ø–¶–¨ (–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 3):
- [ ] –î–æ–¥–∞—Ç–∏ Redis –∫–µ—à—É–≤–∞–Ω–Ω—è
- [ ] –î–æ–¥–∞—Ç–∏ Celery –¥–ª—è background tasks
- [ ] –ù–∞–ø–∏—Å–∞—Ç–∏ unit tests
- [ ] –î–æ–¥–∞—Ç–∏ monitoring (Sentry)

---

## üéØ –ì–û–õ–û–í–ù–Ü –í–ò–°–ù–û–í–ö–ò

### ‚úÖ –©–û –ü–†–ê–¶–Æ–Ñ:
- –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –ø—ñ–¥–∫–ª—é—á–µ–Ω–∞
- HubSpot API –ø—Ä–∞—Ü—é—î
- –ë–∞–∑–æ–≤–∏–π CRUD —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î

### ‚ùå –©–û –ù–ï –ü–†–ê–¶–Æ–Ñ –ù–û–†–ú–ê–õ–¨–ù–û:
- **–ù–µ–º–∞—î –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫** - —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ –≤–ø–∞—Å—Ç–∏
- **–ù–µ–º–∞—î –ª–æ–≥—É–≤–∞–Ω–Ω—è** - –Ω–µ–º–æ–∂–ª–∏–≤–æ –¥–µ–±–∞–∂–∏—Ç–∏
- **–°–ª–∞–±–∫–∞ –±–µ–∑–ø–µ–∫–∞** - –º–æ–∂–ª–∏–≤—ñ –∞—Ç–∞–∫–∏
- **–ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é** - –ø–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏
- **–ù–µ–º–∞—î —Ç–µ—Å—Ç—ñ–≤** - –∫–æ–¥ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∏–π

### üö® –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø:
**–ù–ï –ó–ê–ü–£–°–ö–ê–¢–ò –í PRODUCTION** –±–µ–∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å!

---

## üìû –©–û –†–û–ë–ò–¢–ò –î–ê–õ–Ü?

1. **–ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –ø–æ–≤–Ω–∏–π –∞–Ω–∞–ª—ñ–∑:** `–ê–ù–ê–õ–Ü–ó_–ü–†–û–ï–ö–¢–£.md`
2. **–ü–æ—á–∞—Ç–∏ –∑ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º** (–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 1)
3. **–¢–µ—Å—Ç—É–≤–∞—Ç–∏ –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**
4. **–°—Ç–≤–æ—Ä–∏—Ç–∏ backup –ë–î** –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–∞–º–∏

---

## üîß –®–í–ò–î–ö–Ü –ö–û–ú–ê–ù–î–ò –î–õ–Ø –°–¢–ê–†–¢–£

```bash
# 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ backup –ë–î
pg_dump real_estate_agents > backup_$(date +%Y%m%d).sql

# 2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –¥–ª—è –ª–æ–≥—ñ–≤
mkdir logs

# 3. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞–∫–µ—Ç–∏
pip install Flask-WTF Flask-Limiter Flask-Bcrypt alembic python-dotenv

# 4. –°—Ç–≤–æ—Ä–∏—Ç–∏ .env —Ñ–∞–π–ª (—è–∫—â–æ –Ω–µ–º–∞—î)
cp env_example.txt .env

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
python test_hubspot.py
```

---

**–î–∞—Ç–∞:** 1 –∂–æ–≤—Ç–Ω—è 2025  
**–í–µ—Ä—Å—ñ—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ü–û–¢–†–ï–ë–£–Ñ –£–í–ê–ì–ò

