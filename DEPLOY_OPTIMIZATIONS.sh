#!/bin/bash

echo "üöÄ –î–ï–ü–õ–û–ô –û–ü–¢–ò–ú–Ü–ó–ê–¶–Ü–ô –î–õ–Ø –®–í–ò–î–ö–û–°–¢–Ü"
echo "=========================================="
echo ""

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ —î –∑–º—ñ–Ω–∏
if [ -z "$(git status --porcelain app.py)" ]; then
    echo "‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω –≤ app.py"
    exit 0
fi

echo "üìù –ó–º—ñ–Ω–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ, –≥–æ—Ç—É—é –¥–æ –¥–µ–ø–ª–æ—é..."
echo ""

# –ü–æ–∫–∞–∑–∞—Ç–∏ —â–æ –∑–º—ñ–Ω–∏–ª–æ—Å—è
echo "–ó–º—ñ–Ω–∏ –≤ app.py:"
git diff app.py --stat
echo ""

# –ü–∏—Ç–∞—î–º–æ —á–∏ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏
read -p "–ó–∞–∫–æ–º—ñ—Ç–∏—Ç–∏ —Ç–∞ –∑–∞–ø—É—à–∏—Ç–∏ –∑–º—ñ–Ω–∏? (y/N): " -n 1 -r
echo ""
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "‚ùå –°–∫–∞—Å–æ–≤–∞–Ω–æ"
    exit 1
fi

# –î–æ–¥–∞—Ç–∏ –∑–º—ñ–Ω–∏
echo "üì¶ –î–æ–¥–∞—é –∑–º—ñ–Ω–∏ –¥–æ git..."
git add app.py gunicorn_config.py

# –ö–æ–º—ñ—Ç
echo "üíæ –°—Ç–≤–æ—Ä—é—é –∫–æ–º—ñ—Ç..."
git commit -m "‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ: –≤–∏–º–∫–Ω–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é HubSpot —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ SQL –∑–∞–ø–∏—Ç–∏ –≤ dashboard"

# –ü–æ–∫–∞–∑–∞—Ç–∏ —â–æ –±—É–¥–µ –∑–∞–ø—É—à–µ–Ω–æ
echo ""
echo "üì§ –ë—É–¥–µ –∑–∞–ø—É—à–µ–Ω–æ:"
git log origin/main..HEAD --oneline

# –ü–∏—Ç–∞—î–º–æ —á–∏ –ø—É—à–∏—Ç–∏
read -p "–ó–∞–ø—É—à–∏—Ç–∏ –≤ origin/main? (y/N): " -n 1 -r
echo ""
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "‚ùå Push —Å–∫–∞—Å–æ–≤–∞–Ω–æ. –í–∏–∫–æ–Ω–∞–π—Ç–µ –≤—Ä—É—á–Ω—É: git push origin main"
    exit 1
fi

# Push
echo "üöÄ –ü—É—à–∏–º–æ –∑–º—ñ–Ω–∏..."
git push origin main

echo ""
echo "‚úÖ –ó–º—ñ–Ω–∏ –∑–∞–ø—É—à–µ–Ω–æ!"
echo ""
echo "üìã –¢–µ–ø–µ—Ä –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –≤–∏–∫–æ–Ω–∞–π—Ç–µ:"
echo "   cd /home/pro-part-agent/htdocs/agent.pro-part.online/propart-real-estate-hub"
echo "   git pull"
echo "   sudo systemctl restart propart"
echo ""

