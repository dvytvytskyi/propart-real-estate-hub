# ‚úÖ –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –§–û–¢–û –¢–ê –î–û–ö–£–ú–ï–ù–¢–Ü–í –ù–ï–†–£–•–û–ú–û–°–¢–Ü

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**

–ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ/—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—ñ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ **—Ñ–æ—Ç–æ —Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞–ª–∏—Å—è**, —Ö–æ—á–∞ —Ñ–æ—Ä–º–∞ –º–∞–ª–∞ –ø–æ–ª—è –¥–ª—è —ó—Ö –≤–∏–±–æ—Ä—É.

---

## üîç **–ü—Ä–∏—á–∏–Ω–∞:**

–£ —Ñ—É–Ω–∫—Ü—ñ—è—Ö `create_property()` —Ç–∞ `edit_property()` **–Ω–µ –±—É–ª–æ –∫–æ–¥—É –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ñ–∞–π–ª—ñ–≤** –∑ —Ñ–æ—Ä–º–∏:

```python
# ‚ùå –ë–£–õ–û:
@app.route('/properties/create', methods=['GET', 'POST'])
def create_property():
    if form.validate_on_submit():
        property_obj = Property(...)
        db.session.add(property_obj)
        db.session.commit()
        # üî¥ –ù–µ–º–∞—î –æ–±—Ä–æ–±–∫–∏ —Ñ–∞–π–ª—ñ–≤!
```

–§–æ—Ä–º–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è–ª–∞ —Ñ–∞–π–ª–∏ (`name="photos"`, `name="documents"`), –∞–ª–µ —Å–µ—Ä–≤–µ—Ä —ó—Ö **—ñ–≥–Ω–æ—Ä—É–≤–∞–≤**.

---

## ‚úÖ **–©–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ:**

### **1. –§—É–Ω–∫—Ü—ñ—è `create_property()` (—Ä—è–¥–∫–∏ 3171-3251)**

–î–æ–¥–∞–Ω–æ –æ–±—Ä–æ–±–∫—É —Ñ–∞–π–ª—ñ–≤ –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±'—î–∫—Ç–∞ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ:

```python
# ‚úÖ –°–¢–ê–õ–û:
@app.route('/properties/create', methods=['GET', 'POST'])
def create_property():
    if form.validate_on_submit():
        property_obj = Property(...)
        db.session.add(property_obj)
        db.session.flush()  # –û—Ç—Ä–∏–º—É—î–º–æ ID
        
        # üì∏ –û–ë–†–û–ë–ö–ê –§–û–¢–û–ì–†–ê–§–Ü–ô
        photos = request.files.getlist('photos')
        for photo in photos:
            if photo and photo.filename:
                filename = f"{property_obj.id}_{timestamp}_{photo.filename}"
                file_url = upload_file_to_s3(photo, filename)
                if file_url:
                    property_photo = PropertyPhoto(...)
                    db.session.add(property_photo)
        
        # üìÑ –û–ë–†–û–ë–ö–ê –î–û–ö–£–ú–ï–ù–¢–Ü–í
        documents = request.files.getlist('documents')
        for document in documents:
            if document and document.filename:
                filename = f"{property_obj.id}_{timestamp}_{document.filename}"
                file_url = upload_file_to_s3(document, filename)
                if file_url:
                    property_doc = PropertyDocument(...)
                    db.session.add(property_doc)
        
        db.session.commit()
```

### **2. –§—É–Ω–∫—Ü—ñ—è `edit_property()` (—Ä—è–¥–∫–∏ 3253-3324)**

–î–æ–¥–∞–Ω–æ –æ–±—Ä–æ–±–∫—É –ù–û–í–ò–• —Ñ–∞–π–ª—ñ–≤ –ø—Ä–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—ñ:

```python
# ‚úÖ –î–û–î–ê–ù–û:
# –û–±—Ä–æ–±–∫–∞ –ù–û–í–ò–• —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ–π
photos = request.files.getlist('photos')
for photo in photos:
    if photo and photo.filename:
        # –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–∞ –¥–æ–¥–∞—î–º–æ –¥–æ —ñ—Å–Ω—É—é—á–æ—ó –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ
        
# –û–±—Ä–æ–±–∫–∞ –ù–û–í–ò–• –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤  
documents = request.files.getlist('documents')
for document in documents:
    if document and document.filename:
        # –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–∞ –¥–æ–¥–∞—î–º–æ –¥–æ —ñ—Å–Ω—É—é—á–æ—ó –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ
```

---

## üìã **–Ø–∫ –ø—Ä–∞—Ü—é—î:**

### **–ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ:**

1. ‚úÖ –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –æ–±'—î–∫—Ç `Property` –∑ –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏
2. ‚úÖ `db.session.flush()` - –æ—Ç—Ä–∏–º—É—î–º–æ ID –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ
3. ‚úÖ –ó—á–∏—Ç—É—é—Ç—å—Å—è —Ñ–∞–π–ª–∏ –∑ `request.files.getlist('photos')`
4. ‚úÖ –ö–æ–∂–Ω–µ —Ñ–æ—Ç–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –Ω–∞ S3 —á–µ—Ä–µ–∑ `upload_file_to_s3()`
5. ‚úÖ –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑–∞–ø–∏—Å `PropertyPhoto` –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –Ω–∞ —Ñ–∞–π–ª
6. ‚úÖ –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ ‚Üí `PropertyDocument`
7. ‚úÖ `db.session.commit()` - –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤—Å–µ –≤ –ë–î

### **–§–æ—Ä–º–∞—Ç —ñ–º–µ–Ω—ñ —Ñ–∞–π–ª—É:**

```
{property_id}_{timestamp}_{original_filename}
```

**–ü—Ä–∏–∫–ª–∞–¥:**
```
1_1761558456_house.jpg
1_1761558457_floor_plan.pdf
```

---

## üóÇÔ∏è **–ú–æ–¥–µ–ª—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:**

### **PropertyPhoto:**
```python
id, property_id, filename, file_path
```

### **PropertyDocument:**
```python
id, property_id, filename, file_path
```

---

## üß™ **–Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**

### **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ:**

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ http://localhost:5001/properties/create
2. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–æ—Ä–º—É
3. **–í–∏–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ç–æ** (–∫–Ω–æ–ø–∫–∞ "–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó")
4. **–í–∏–±–µ—Ä—ñ—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∏** (–∫–Ω–æ–ø–∫–∞ "–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏")
5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–°—Ç–≤–æ—Ä–∏—Ç–∏"

### **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

‚úÖ –ù–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–∞
‚úÖ –§–æ—Ç–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ –≥–∞–ª–µ—Ä–µ—ó
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫—É

### **–õ–æ–≥–∏:**

```
üì∏ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ: 3 —Ñ–∞–π–ª—ñ–≤
‚úÖ –§–æ—Ç–æ –¥–æ–¥–∞–Ω–æ: 1_1761558456_house.jpg
‚úÖ –§–æ—Ç–æ –¥–æ–¥–∞–Ω–æ: 1_1761558457_interior.jpg
‚úÖ –§–æ—Ç–æ –¥–æ–¥–∞–Ω–æ: 1_1761558458_garden.jpg

üìÑ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤: 2 —Ñ–∞–π–ª—ñ–≤
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç –¥–æ–¥–∞–Ω–æ: 1_1761558459_floor_plan.pdf
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç –¥–æ–¥–∞–Ω–æ: 1_1761558460_contract.pdf
```

---

## üîß **–î–æ–¥–∞—Ç–∫–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:**

### **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ S3:**
- ‚úÖ –§–∞–π–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –Ω–∞ AWS S3
- ‚úÖ Fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —è–∫—â–æ S3 –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
- ‚úÖ –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –Ω–∞–∑–≤–∏ —Ñ–∞–π–ª—ñ–≤ (—É–Ω–∏–∫–Ω–µ–Ω–Ω—è –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤)

### **–í–∞–ª—ñ–¥–∞—Ü—ñ—è:**
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç—É —Ñ–∞–π–ª—ñ–≤ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ (`accept="image/*"`, `accept=".pdf,.doc,.docx"`)
- ‚úÖ –û–±—Ä–æ–±–∫–∞ —Ç—ñ–ª—å–∫–∏ —Ñ–∞–π–ª—ñ–≤ –∑ –Ω–µ–ø—É—Å—Ç–∏–º `filename`
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

---

## üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**

| –§–∞–π–ª | –§—É–Ω–∫—Ü—ñ—è | –î–æ–¥–∞–Ω–æ —Ä—è–¥–∫—ñ–≤ |
|------|---------|---------------|
| `app.py` | `create_property()` | +47 |
| `app.py` | `edit_property()` | +45 |
| **–í—Å—å–æ–≥–æ** | | **+92 —Ä—è–¥–∫–∏** |

---

## üéØ **–ì–û–¢–û–í–û!**

–¢–µ–ø–µ—Ä **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—ñ–¥—Ç—Ä–∏–º—É—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ —Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**! üöÄ

**–î–∞—Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:** 27 –∂–æ–≤—Ç–Ω—è 2025
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–ò–ü–†–ê–í–õ–ï–ù–û

